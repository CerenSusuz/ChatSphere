@page "/register"
@using ChatSphere.Client.Shared
@inject IAuthService AuthService
@inject NavigationManager Navigation

<PageTitle>Register - ChatSphere</PageTitle>
    <div class="theme-button-container">
        <ThemeToggle />
    </div>
<div class="register-container">
    <div class="register-card">
        <h2>Create Account 📝</h2>
        <p>Join ChatSphere and start chatting!</p>

        <input @bind="Username" placeholder="Username" class="input" />
        <input @bind="Email" placeholder="Email" type="email" class="input" />
        <input @bind="Password" placeholder="Password" type="password" class="input" />
        <input @bind="ConfirmPassword" placeholder="Confirm Password" type="password" class="input" />

        <button class="button" @onclick="HandleRegister">Register</button>

        @if (!string.IsNullOrWhiteSpace(ErrorMessage))
    {
        <p class="error">@ErrorMessage</p>
    }

        <p class="login-link">
            Already have an account? <a href="/login">Login here</a>
        </p>
    </div>
</div>

@code {
private string Username { get; set; } = "";
private string Email { get; set; } = "";
private string Password { get; set; } = "";
private string ConfirmPassword { get; set; } = "";
private string ErrorMessage { get; set; } = "";

private async Task HandleRegister()
{
    if (Password != ConfirmPassword)
    {
        ErrorMessage = "Passwords do not match.";
        return;
    }

    var success = await AuthService.RegisterAsync(Username, Email, Password);
    if (success)
    {
        Navigation.NavigateTo("/login");
    }
    else
    {
        ErrorMessage = "Registration failed.";
    }
}
}
