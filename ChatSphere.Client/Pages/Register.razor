@page "/register"
@inject IAuthService AuthService
@inject NavigationManager Navigation

<PageTitle>Register - ChatSphere</PageTitle>

<div class="form-wrapper">
    <div class="form-box">
        <h2 class="form-title">Join ChatSphere</h2>
        <p class="form-subtitle">Create your free account</p>

        <input @bind="Username" placeholder="Username" />
        <input @bind="Email" placeholder="Email" />
        <input @bind="Password" type="password" placeholder="Password" />
        <input @bind="ConfirmPassword" type="password" placeholder="Confirm Password" />
        <button @onclick="HandleRegister" class="form-button">Register</button>

        <p class="error-message">@ErrorMessage</p>

        <div class="link">
            Already have an account? <a href="/login">Login here</a>
        </div>
    </div>
</div>

@code {
    private string Username { get; set; } = "";
    private string Email { get; set; } = "";
    private string Password { get; set; } = "";
    private string ConfirmPassword { get; set; } = "";
    private string ErrorMessage { get; set; } = "";

    private async Task HandleRegister()
    {
        if (Password != ConfirmPassword)
        {
            ErrorMessage = "Passwords do not match.";
            return;
        }

        var success = await AuthService.RegisterAsync(Username, Email, Password);
        if (success)
        {
            Navigation.NavigateTo("/login");
        }
        else
        {
            ErrorMessage = "Registration failed.";
        }
    }
}
