@page "/register"
@inject IAuthService AuthService
@inject NavigationManager Navigation

<PageTitle>Register - ChatSphere</PageTitle>

<div class="form-container">
    <div class="form-card">
        <h2 class="form-title">Join ChatSphere</h2>
        <p class="form-subtitle">Create your account</p>

        <div class="form-group">
            <input @bind="Username" placeholder="Username" class="form-input" />
        </div>

        <div class="form-group">
            <input @bind="Email" placeholder="Email" class="form-input" />
        </div>

        <div class="form-group">
            <input @bind="Password" type="password" placeholder="Password" class="form-input" />
        </div>

        <div class="form-group">
            <input @bind="ConfirmPassword" type="password" placeholder="Confirm Password" class="form-input" />
        </div>

        <button @onclick="HandleRegister" class="form-button">Register</button>
        <p class="error-message">@ErrorMessage</p>

        <div class="form-footer">
            <p>Already have an account? <a href="/login" class="form-link">Login here</a></p>
        </div>
    </div>
</div>

@code {
    private string Username { get; set; } = "";
    private string Email { get; set; } = "";
    private string Password { get; set; } = "";
    private string ConfirmPassword { get; set; } = "";
    private string ErrorMessage { get; set; } = "";

    private async Task HandleRegister()
    {
        if (Password != ConfirmPassword)
        {
            ErrorMessage = "Passwords do not match.";
            return;
        }

        var success = await AuthService.RegisterAsync(username: Username, email: Email, password: Password);


        if (success)
        {
            Navigation.NavigateTo("/login");
        }
        else
        {
            ErrorMessage = "Registration failed. Please try again.";
        }
    }
}
